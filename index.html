<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Configurateur TRADIHOME</title>

  <!-- Web component model-viewer -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      background: #ddd;  /* on voit tout de suite si la page charge */
      overflow: hidden;
    }
    model-viewer {
      width: 100%; height: 100%;
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>

  <model-viewer
    id="mv"
    src="https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/TRADIHOME.glb"
    alt="Maison TRADIHOME"
    camera-controls
    auto-rotate
    environment-image="https://modelviewer.dev/shared-assets/environments/venice_sunset_1k.hdr"
    shadow-intensity="1"
    exposure="1.3"
    loading="eager">
  </model-viewer>

  <!-- Notre script de texturage, plac√© apr√®s le <model-viewer> -->
  <script type="module">
    import { TextureLoader } from 'https://unpkg.com/three@0.150.1/build/three.module.js';

    // Mapping mesh-name ‚Üí URL RAW GitHub de la BaseColor
    const texturesMap = {
      'Murs':        'https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/Murs_baseColor.png',
      'Toit1':       'https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/Toit1_baseColor.png',
      'Volets':      'https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/Volets_baseColor.png',
      'dalles':      'https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/dalles_baseColor.jpeg',
      'goutieres':   'https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/goutieres_baseColor.jpeg',
      'material_32': 'https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/material_32_baseColor.png',
      'poutrine01':  'https://raw.githubusercontent.com/zeyneb2626/Configurateur_LULY/main/poutrine01_baseColor.jpeg'
    };

    const mv = document.getElementById('mv');
    mv.addEventListener('load', (event) => {
      console.log('üîÑ ModelViewer ‚Äúload‚Äù event re√ßu', event.detail.model);
      const loader = new TextureLoader();
      const model = event.detail.model;

      // On traverse TOUTES les nodes de la sc√®ne interne
      model.traverse((node) => {
        if (!node.isMesh) return;
        console.log('‚Üí Mesh trouv√© :', node.name);

        // Si on a une texture √† appliquer sur ce mesh...
        const url = texturesMap[node.name];
        if (url) {
          console.log(`   ‚Ä¢ Chargement de la texture pour "${node.name}" ‚Üí ${url}`);
          loader.load(
            url,
            (tex) => {
              node.material.map = tex;
              node.material.needsUpdate = true;
              console.log(`   ‚úì Texture appliqu√©e sur ${node.name}`);
            },
            undefined,
            (err) => {
              console.error(`   ‚úó Erreur chargement texture ${node.name}`, err);
            }
          );
        }
      });
    });

    // Astuce debug : ouvrez la console (F12) pour voir la liste des meshes et rep√©rer s'ils ont
    // bien les noms "Murs", "Toit1", etc. Si un mesh a un nom diff√©rent, ajoutez‚Äêle √† texturesMap.
  </script>

</body>
</html>


